# 💼 Portfolio Guard - 股票组合管理应用

一个**完全私密**的个人投资管理工具。您的所有交易数据都保存在自己的电脑上，不会上传到任何服务器，保护您的投资隐私。

---

## ⚡ 快速开始（3 步上手）

如果您是第一次使用，请按照以下步骤操作：

### 第 1 步：安装 Node.js（如果还没有安装）

1. 访问 https://nodejs.org/zh-cn
2. 下载并安装 **LTS 版本**
3. 安装完成后，重新打开终端/命令提示符

> 💡 不知道是否已安装？打开终端输入 `node -v`，如果显示版本号就说明已安装。

### 第 2 步：安装项目依赖

1. 打开终端/命令提示符
2. 进入项目文件夹（拖拽文件夹到终端窗口即可）
3. 运行：`npm install`
4. 运行：`npm run db:init`

### 第 3 步：启动应用

**最简单的方式**：双击项目文件夹中的 `启动应用.sh`（Mac）或 `启动应用.bat`（Windows）

然后等待启动完成，在浏览器打开 `http://localhost:3000` 即可使用！

> 📖 需要更详细的说明？请继续阅读下面的完整文档。

---

## 📋 目录

- [功能介绍](#-功能介绍)
- [安装前准备](#-安装前准备)
- [安装步骤](#-安装步骤)
- [启动应用](#-启动应用)
  - [方式一：双击启动脚本（最简单）](#方式一双击启动脚本-最简单强烈推荐)
  - [方式二：创建桌面快捷方式](#方式二创建桌面快捷方式-推荐一键启动)
  - [方式三：使用命令行启动](#方式三使用命令行启动)
  - [方式四：打包成桌面应用（最专业）](#方式四打包成桌面应用-最专业一次打包永久使用)
- [使用指南](#-使用指南)
- [常见问题](#-常见问题)

---

## ✨ 功能介绍

| 功能 | 说明 |
|------|------|
| 📊 持仓管理 | 查看总资产、总盈亏、今日盈亏 |
| 📈 交易录入 | 记录买入/卖出操作，自动计算成本 |
| 💹 行情刷新 | 自动获取股票最新价格（支持A股、港股、美股）|
| 📉 净值曲线 | 查看历史资产变化趋势 |
| 🥧 持仓分析 | 饼图展示各股票占比 |
| 🔒 数据安全 | 所有数据只保存在您的电脑上 |

---

## 🔧 安装前准备

在使用本应用之前，您需要先安装 **Node.js**（一个运行程序的工具）。

### 第一步：检查是否已安装 Node.js

1. **打开终端**
   - **Mac 用户**：按 `Command + 空格`，输入 `终端` 或 `Terminal`，回车打开
   - **Windows 用户**：按 `Win + R`，输入 `cmd`，回车打开

2. **输入以下命令检查**（复制粘贴即可）：
   ```bash
   node -v
   ```

3. **查看结果**：
   - 如果显示类似 `v18.0.0` 或 `v20.0.0` 的版本号 → ✅ 已安装，可以跳到[安装步骤](#-安装步骤)
   - 如果显示 `command not found` 或 `不是内部命令` → ❌ 未安装，继续下一步

### 第二步：安装 Node.js

#### Mac 用户（推荐方式）

1. 访问 Node.js 官网：https://nodejs.org/zh-cn
2. 点击下载 **LTS 版本**（长期支持版，更稳定）
3. 双击下载的 `.pkg` 文件
4. 按照提示一路点击"继续"完成安装
5. 安装完成后，**关闭并重新打开终端**
6. 再次输入 `node -v` 确认安装成功

#### Windows 用户

1. 访问 Node.js 官网：https://nodejs.org/zh-cn
2. 点击下载 **LTS 版本**
3. 双击下载的 `.msi` 文件
4. 安装过程中**全部选择默认选项**，一路点击"Next"
5. 安装完成后，**关闭并重新打开命令提示符**
6. 再次输入 `node -v` 确认安装成功

---

## 📦 安装步骤

### 第一步：找到并打开项目文件夹

1. **找到项目文件夹**
   - 项目文件夹通常位于您的**桌面**、**下载文件夹**或**文档文件夹**
   - 文件夹名称应该是 `投资管理` 或 `portfolio-guard`
   - 如果您是从 GitHub 下载的，可能是一个压缩包，需要先解压
   
   > 💡 **找不到项目文件夹？**
   > - 在文件管理器中搜索 `投资管理` 或 `portfolio-guard`
   > - 检查下载文件夹和桌面
   > - 如果您是从代码仓库克隆的，检查克隆到的位置

2. **打开终端/命令提示符**
   - **Mac 用户**：按 `Command + 空格`，输入 `终端` 或 `Terminal`，回车
   - **Windows 用户**：按 `Win + R`，输入 `cmd`，回车

3. **进入项目文件夹**

   **方法一：使用命令（需要知道完整路径）**
   
   **Mac 用户**：
   ```bash
   cd ~/Desktop/Projects/投资管理
   ```
   
   **Windows 用户**（请根据实际路径修改）：
   ```bash
   cd C:\Users\您的用户名\Desktop\Projects\投资管理
   ```
   
   **方法二：拖拽文件夹（最简单，推荐）**
   
   - 在终端输入 `cd `（注意 cd 后面有一个空格）
   - 不要按回车，直接把项目文件夹从文件管理器拖拽到终端窗口
   - 路径会自动填入，然后按回车
   
   **方法三：右键菜单（Mac 推荐）**
   
   - **Mac**：在 Finder 中右键点击项目文件夹，选择"服务" → "新建位于文件夹位置的终端窗口"
   - **Windows**：在文件资源管理器中，按住 `Shift` 键，右键点击项目文件夹，选择"在此处打开 PowerShell 窗口"或"在此处打开命令窗口"
   
   > 💡 **验证是否进入正确文件夹**：
   > - 在终端输入 `ls`（Mac）或 `dir`（Windows）
   > - 应该能看到 `package.json`、`启动应用.sh`（Mac）或 `启动应用.bat`（Windows）等文件

### 第二步：安装依赖

在终端中输入以下命令（复制粘贴），然后按回车：

```bash
npm install
```

> ⏳ **重要提示**：
> - 这个过程需要下载一些必要的文件，可能需要 **1-5 分钟**，请耐心等待
> - 如果看到一些黄色的 `WARN` 警告信息，这是**正常的**，不用担心
> - 如果下载很慢，请参考[常见问题 Q2](#q2-npm-install-很慢或失败)使用国内镜像源
> - 如果出现错误，请检查网络连接，或参考[常见问题](#-常见问题)部分

**成功标志**：等待看到类似下面的信息就表示安装完成：
```
added xxx packages in xxs
```

> ❌ **如果看到错误**：
> - 请检查是否已正确安装 Node.js（运行 `node -v` 确认）
> - 请检查网络连接是否正常
> - 请参考[常见问题](#-常见问题)部分

### 第三步：初始化数据库

继续在终端输入：

```bash
npm run db:init
```

**成功标志**：看到以下信息表示成功：
```
数据库初始化完成!
```

> 💡 **提示**：
> - 这个步骤只需要运行一次
> - 如果以后重新安装，也需要运行这个命令
> - 如果看到错误，请检查上一步（安装依赖）是否成功完成

### 第四步：验证安装（可选但推荐）

安装完成后，建议验证一下是否一切正常：

1. **检查 Node.js**：
   ```bash
   node -v
   ```
   应该显示版本号，如 `v20.0.0`

2. **检查 npm**：
   ```bash
   npm -v
   ```
   应该显示版本号，如 `10.0.0`

3. **检查项目文件**：
   - 确认项目文件夹中有 `node_modules` 文件夹（依赖已安装）
   - 确认项目文件夹中有 `启动应用.sh`（Mac）或 `启动应用.bat`（Windows）文件

如果以上都正常，恭喜您！安装完成，可以开始使用了！🎉

---

## 🚀 启动应用

安装完成后，有三种方式可以启动应用，**推荐使用方式一（最简单）**：

---

### 方式一：双击启动脚本（⭐ 最简单，强烈推荐）

这是**最简单**的启动方式，适合所有用户，特别是不会使用命令行的朋友。

#### Mac 用户

1. **找到启动脚本**：在项目文件夹中找到 `启动应用.sh` 文件
2. **设置执行权限**（只需第一次）：
   - 右键点击 `启动应用.sh` 文件
   - 选择"显示简介"（Get Info）
   - 在"共享与权限"（Sharing & Permissions）中，勾选"执行"（Execute）
   - 或者打开终端，输入：
     ```bash
     chmod +x "启动应用.sh"
     ```
3. **双击启动**：双击 `启动应用.sh` 文件
4. **等待启动**：会打开一个终端窗口，自动启动应用
5. **打开浏览器**：
   - 等待启动窗口显示 `ready in xxx ms` 和 `Local: http://localhost:3000/`
   - 打开浏览器（Chrome、Edge、Safari 等）
   - 在地址栏输入：`http://localhost:3000`
   - 按回车，即可看到应用界面！🎉

#### Windows 用户

1. **找到启动脚本**：在项目文件夹中找到 `启动应用.bat` 文件
2. **双击启动**：直接双击 `启动应用.bat` 文件
3. **等待启动**：会打开一个命令提示符窗口，自动启动应用
4. **打开浏览器**：
   - 等待启动窗口显示 `ready in xxx ms` 和 `Local: http://localhost:3000/`
   - 打开浏览器（Chrome、Edge 等）
   - 在地址栏输入：`http://localhost:3000`
   - 按回车，即可看到应用界面！🎉

> 💡 **重要提示**：
> - ✅ 首次运行会自动安装依赖和初始化数据库，可能需要 **1-5 分钟**，请耐心等待
> - ✅ 启动后请**保持窗口打开**，关闭应用时在窗口按 `Ctrl + C`（Mac 用户可能需要按 `Control + C`）
> - ✅ 如果双击无法运行，请参考下面的"创建桌面快捷方式"部分或[常见问题 Q8](#q8-mac-双击启动脚本没有反应)
> - ✅ 启动成功后，终端窗口会显示 `ready in xxx ms`，这时才能在浏览器中打开应用

---

### 方式二：创建桌面快捷方式（⭐ 推荐，一键启动）

创建桌面快捷方式后，每次只需双击桌面图标即可启动应用。

#### Mac 用户

**方法 A：使用 Automator（推荐）**

1. 打开 **Automator**（按 `Command + 空格`，输入 `Automator`）
2. 选择 **"应用程序"**（Application）
3. 在左侧搜索栏输入 `运行 Shell 脚本`（Run Shell Script），拖到右侧
4. 在脚本框中输入以下内容（请替换为您的实际路径）：
   ```bash
   cd ~/Desktop/Projects/投资管理
   open -a Terminal "启动应用.sh"
   ```
5. 点击菜单 **文件 → 存储**（File → Save）
6. 命名为 `Portfolio Guard`，保存到 **应用程序** 文件夹
7. 在 **应用程序** 文件夹中找到 `Portfolio Guard`，拖到桌面或 Dock

**方法 B：使用终端命令（更简单）**

1. 打开终端
2. 输入以下命令（请替换为您的实际路径）：
   ```bash
   cd ~/Desktop/Projects/投资管理
   chmod +x "启动应用.sh"
   ln -s "$(pwd)/启动应用.sh" ~/Desktop/启动应用
   ```
3. 现在桌面上会有一个快捷方式，双击即可启动

**方法 C：直接创建应用程序别名（最简单）**

1. 打开 **Finder**，进入项目文件夹
2. 找到 `启动应用.sh` 文件
3. 按住 `Option + Command` 键，拖拽文件到桌面
4. 会创建一个别名，双击即可启动
5. （可选）重命名为 `Portfolio Guard` 或 `投资管理`

#### Windows 用户

1. **右键点击桌面** → 选择 **"新建"** → **"快捷方式"**
2. **输入位置**（请替换为您的实际路径）：
   ```
   C:\Users\您的用户名\Desktop\Projects\投资管理\启动应用.bat
   ```
   > 💡 或者点击"浏览"，找到 `启动应用.bat` 文件
3. **点击"下一步"**
4. **输入名称**：`Portfolio Guard` 或 `投资管理`
5. **点击"完成"**
6. **（可选）更改图标**：
   - 右键点击快捷方式 → **"属性"**
   - 点击 **"更改图标"**
   - 选择一个您喜欢的图标
7. 现在双击桌面快捷方式即可启动应用！

---

### 方式三：使用命令行启动

如果您熟悉命令行操作，可以使用以下方式：

#### 一键启动（推荐）

在终端/命令提示符中，进入项目目录后运行：

```bash
npm run dev
```

然后在浏览器打开 `http://localhost:3000`

#### 分别启动（适合调试）

**第一步：启动后端服务**

```bash
npm run dev:backend
```

看到 `服务器已启动: http://127.0.0.1:3001` 表示成功。

> ⚠️ **注意**：这个窗口需要保持打开，不要关闭！

**第二步：打开新终端窗口，启动前端**

在新窗口中进入项目目录，然后运行：

```bash
npm run dev:frontend
```

看到 `ready in xxx ms` 和 `Local: http://localhost:3000/` 表示成功。

**第三步：打开浏览器**

在浏览器地址栏输入 `http://localhost:3000` 即可使用。

---

### 方式四：打包成桌面应用（⭐ 最专业，一次打包永久使用）

如果您希望像普通软件一样，双击图标就能打开应用（不需要浏览器），可以打包成桌面应用。

#### 打包步骤

1. **确保已完成安装步骤**（安装依赖、初始化数据库）

2. **打包应用**：

   **Mac 用户**：
   ```bash
   npm run build
   npm run dist
   ```

   **Windows 用户**：
   ```bash
   npm run build
   npm run dist
   ```

3. **找到打包文件**：
   - 打包完成后，在 `release` 文件夹中会生成安装包
   - **Mac**：会生成 `.dmg` 文件
   - **Windows**：会生成 `.exe` 安装程序

4. **安装应用**：
   - **Mac**：双击 `.dmg` 文件，将应用拖到"应用程序"文件夹
   - **Windows**：双击 `.exe` 文件，按照提示安装

5. **使用应用**：
   - 安装后，在应用程序列表中找到 **"Portfolio Guard"**
   - 双击即可启动，无需浏览器，无需命令行！

> 💡 **提示**：
> - 打包过程可能需要 5-10 分钟，请耐心等待
> - 打包后的应用可以分发给其他用户使用
> - 首次打包建议使用 `npm run pack` 先测试（不生成安装包，只生成可执行文件）

---

## 📝 首次使用必读

### ✅ 安装检查清单

在开始使用前，请确认：

- [ ] ✅ 已安装 Node.js（运行 `node -v` 有版本号显示）
- [ ] ✅ 已运行 `npm install` 且没有错误
- [ ] ✅ 已运行 `npm run db:init` 且显示"数据库初始化完成"
- [ ] ✅ 已找到启动脚本文件（`启动应用.sh` 或 `启动应用.bat`）

### 🎯 推荐使用方式

**对于完全不会编程的用户**：
1. ⭐ **首选**：使用[方式二：创建桌面快捷方式](#方式二创建桌面快捷方式-推荐一键启动)
2. ⭐ **备选**：使用[方式一：双击启动脚本](#方式一双击启动脚本-最简单强烈推荐)

**对于有一定技术基础的用户**：
1. ⭐ **首选**：使用[方式四：打包成桌面应用](#方式四打包成桌面应用-最专业一次打包永久使用)
2. ⭐ **备选**：使用[方式三：命令行启动](#方式三使用命令行启动)

### 📍 重要提示

1. **数据安全**：您的所有数据保存在 `data/portfolio-guard.db` 文件中，请定期备份
2. **保持窗口打开**：使用启动脚本时，请保持启动窗口打开，关闭应用时按 `Ctrl + C`
3. **浏览器地址**：应用启动后，在浏览器打开 `http://localhost:3000`（注意是 http 不是 https）
4. **首次启动**：首次使用启动脚本时，会自动安装依赖，可能需要等待 1-3 分钟

---

## 📖 使用指南

### 1️⃣ 录入交易

1. 点击右上角的 **「新建交易」** 按钮
2. 选择 **买入** 或 **卖出**
3. 填写信息：
   - **股票代码**：如 `600000`（A股）、`AAPL`（美股）、`0700`（港股）
   - **股票名称**：可选，如"浦发银行"
   - **成交价格**：买入/卖出的价格
   - **成交数量**：买入/卖出的股数
   - **手续费**：可选
   - **交易日期**：选择实际交易日期
4. 点击 **「确认买入」** 或 **「确认卖出」**

### 2️⃣ 刷新行情

点击 **「刷新行情」** 按钮，系统会自动获取所有持仓股票的最新价格。

### 3️⃣ 生成快照

点击 **「快照」** 按钮可以保存当天的资产数据，用于生成净值曲线。

### 4️⃣ 导出数据

点击 **「导出」** 按钮可以将所有交易记录导出为 CSV 文件（可用 Excel 打开）。

### 5️⃣ 设置

点击右上角的 **⚙️ 齿轮图标**，可以：
- 切换深色/浅色主题
- 设置行情刷新频率
- 选择基准币种

---

## ❓ 常见问题

### Q1: 提示 "command not found" 或 "不是内部命令"

**原因**：Node.js 没有正确安装

**解决方法**：
1. 请按照[安装前准备](#-安装前准备)重新安装 Node.js
2. 安装后记得**重新打开终端/命令提示符**

---

### Q2: npm install 很慢或失败

**原因**：网络问题，国内访问 npm 官方源较慢

**解决方法**：使用国内镜像源

```bash
npm config set registry https://registry.npmmirror.com
```

然后重新运行：
```bash
npm install
```

---

### Q3: 启动后浏览器打不开页面

**检查步骤**：

1. 确认后端服务正在运行（第一个终端窗口显示"服务器已启动"）
2. 确认前端服务正在运行（第二个终端窗口显示"ready in xxx ms"）
3. 确认浏览器地址是 `http://localhost:3000`（注意是 http 不是 https）

---

### Q4: 端口被占用（显示 EADDRINUSE）

**原因**：3000 或 3001 端口被其他程序占用

**解决方法**：

**Mac**：
```bash
# 查找占用 3001 端口的进程
lsof -i:3001
# 然后使用显示的 PID 杀死进程
kill -9 <PID>
```

**Windows**：
```bash
# 查找占用 3001 端口的进程
netstat -ano | findstr :3001
# 然后使用显示的 PID 杀死进程
taskkill /F /PID <PID>
```

---

### Q5: 如何关闭应用？

**如果使用启动脚本或快捷方式**：
- 在启动窗口按 `Ctrl + C`（Mac 用户可能需要按 `Control + C`）
- 关闭浏览器标签页

**如果使用命令行分别启动**：
1. 在运行前端的终端窗口按 `Ctrl + C`
2. 在运行后端的终端窗口按 `Ctrl + C`
3. 关闭浏览器标签页

**如果使用打包的桌面应用**：
- 直接关闭应用窗口即可

---

### Q6: 数据保存在哪里？

您的所有数据都保存在项目目录下的 `data/portfolio-guard.db` 文件中。

**备份数据**：只需复制这个文件到安全的地方即可。

**恢复数据**：将备份的文件复制回 `data/` 目录，覆盖原文件。

---

### Q7: 如何更新应用？

如果获取了新版本的代码：

1. **重新安装依赖**：
   ```bash
   npm install
   ```

2. **如果使用打包的桌面应用**，需要重新打包：
   ```bash
   npm run build
   npm run dist
   ```

---

### Q8: Mac 双击启动脚本没有反应？

**原因**：Mac 系统默认不允许直接执行脚本文件

**解决方法**：

**方法一：使用终端执行（推荐）**
1. 打开终端
2. 输入以下命令（请替换为您的实际路径）：
   ```bash
   cd ~/Desktop/Projects/投资管理
   ./启动应用.sh
   ```

**方法二：设置执行权限**
1. 打开终端
2. 输入以下命令（请替换为您的实际路径）：
   ```bash
   chmod +x ~/Desktop/Projects/投资管理/启动应用.sh
   ```
3. 然后就可以双击运行了

**方法三：使用右键菜单**
1. 右键点击 `启动应用.sh` 文件
2. 选择"打开方式" → "终端"
3. 如果提示"无法打开"，点击"打开"按钮

---

### Q9: Windows 双击启动脚本显示乱码？

**原因**：Windows 命令提示符编码问题

**解决方法**：
1. 右键点击 `启动应用.bat` 文件
2. 选择"编辑"（用记事本打开）
3. 确认文件开头有 `chcp 65001 >nul` 这一行
4. 如果没有，请重新下载或复制启动脚本

---

### Q10: 启动脚本在哪里？

启动脚本位于项目根目录：
- **Mac/Linux**：`启动应用.sh`
- **Windows**：`启动应用.bat`

如果找不到，请检查：
1. 是否在正确的项目文件夹中
2. 文件是否被隐藏（Mac 按 `Command + Shift + .` 显示隐藏文件）

---

### Q11: 启动后浏览器显示"无法访问此网站"？

**可能的原因和解决方法**：

1. **应用还未完全启动**
   - 等待 10-30 秒，看到终端显示 `ready in xxx ms` 后再打开浏览器

2. **地址输入错误**
   - 确认地址是 `http://localhost:3000`（注意是 http 不是 https）
   - 不要添加多余的斜杠或路径

3. **端口被占用**
   - 参考 [Q4](#q4-端口被占用显示-eaddrinuse) 解决端口占用问题

4. **防火墙阻止**
   - Windows：检查防火墙设置，允许 Node.js 访问网络
   - Mac：系统偏好设置 → 安全性与隐私 → 防火墙

---

### Q12: 如何确认应用正在运行？

**检查方法**：

1. **查看终端窗口**：
   - 应该看到类似 `服务器已启动: http://127.0.0.1:3001` 的信息
   - 应该看到类似 `ready in xxx ms` 和 `Local: http://localhost:3000/` 的信息

2. **测试访问**：
   - 在浏览器打开 `http://localhost:3000`
   - 如果能看到应用界面，说明运行正常

3. **检查进程**（高级）：
   - **Mac**：打开"活动监视器"，搜索 `node`
   - **Windows**：打开"任务管理器"，查看是否有 `node.exe` 进程

---

## 🔒 安全说明

- ✅ 所有数据**只保存在您的电脑上**
- ✅ 不会上传到任何云服务器
- ✅ 不需要注册账号
- ✅ 不会收集任何个人信息

---

## 💡 小贴士

1. **定期备份**：建议定期复制 `data/portfolio-guard.db` 文件进行备份
2. **每日快照**：养成每天点击"快照"的习惯，可以生成更完整的净值曲线
3. **及时录入**：交易完成后尽快录入，保持数据准确
4. **使用快捷方式**：创建桌面快捷方式后，使用会更方便
5. **打包应用**：如果经常使用，建议打包成桌面应用，体验更好

---

## 📞 需要帮助？

如果遇到其他问题，可以：

1. **仔细检查上面的常见问题**：大部分问题都有解决方案
2. **确保按照步骤一步一步操作**：不要跳过任何步骤
3. **重启应用**：关闭后重新启动，有时可以解决临时问题
4. **检查安装**：确认 Node.js 已正确安装（运行 `node -v`）
5. **查看错误信息**：终端/命令提示符中的错误信息通常能帮助定位问题

### 🔍 常见错误速查

| 错误信息 | 解决方法 |
|---------|---------|
| `command not found` | 未安装 Node.js，参考[安装前准备](#-安装前准备) |
| `EADDRINUSE` | 端口被占用，参考[Q4](#q4-端口被占用显示-eaddrinuse) |
| `npm install` 很慢 | 使用国内镜像源，参考[Q2](#q2-npm-install-很慢或失败) |
| 浏览器无法访问 | 等待应用完全启动，参考[Q11](#q11-启动后浏览器显示无法访问此网站) |
| 双击脚本无反应 | Mac 用户参考[Q8](#q8-mac-双击启动脚本没有反应) |

---

## 🎉 开始使用

恭喜您完成安装！现在您可以：

1. ✅ 使用启动脚本或快捷方式启动应用
2. ✅ 在浏览器中打开 `http://localhost:3000`
3. ✅ 开始录入您的第一笔交易
4. ✅ 享受私密、安全的投资管理体验

**祝您投资顺利！** 📈💰
